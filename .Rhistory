color = "Cluster",
title = "Cluster Assignments by Speaker Category"
) +
theme_minimal(base_size = 14) +
theme(
panel.grid = element_blank(),
axis.line = element_line(color = "black"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(color = "black"),
strip.text = element_text(face = "bold", size = 14)
)
speaker_clusters2 <- speaker_features %>%
left_join(speaker_clusters %>% select(speaker, cluster),
by = "speaker") %>%
mutate(
category = substr(speaker, 1, 2),
cluster = factor(cluster)
)
ggplot(speaker_clusters2,
aes(x = percent_reported_black,
y = fct_reorder(speaker, percent_reported_black),
color = cluster)) +
geom_point(size = 5, alpha = 0.9) +
scale_color_manual(values = c(
"1" = "#2b7de9",  # White cluster
"2" = "#c23b23",  # Black cluster
"3" = "gray40"    # Ambiguous cluster
)) +
facet_wrap(~ category, scales = "free_y") +
labs(
x = "% Reported Black",
y = "Speaker",
color = "Cluster",
title = "Cluster Assignments by Speaker Category"
) +
theme_minimal(base_size = 14) +
theme(
panel.grid = element_blank(),
axis.line = element_line(color = "black"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(color = "black"),
strip.text = element_text(face = "bold", size = 14)
)
ggplot(df_plot,
aes(x = ground_truth_label,
y = percent_reported_black,
color = ground_truth_label)) +
geom_jitter(width = 0.15, size = 4, alpha = 0.9) +
scale_color_manual(values = c(
"Black"      = "#c23b23",
"White"      = "#2b7de9",
"Ambiguous"  = "gray40"
)) +
labs(
x = "Ground Truth Label",
y = "% Reported Black",
color = "Ground Truth Label"
) +
theme_minimal(base_size = 14) +
theme(
axis.line = element_line(color = "black"),
panel.grid = element_blank()
)
ggplot(df_density,
aes(x = percent_reported_black,
fill = ground_truth_label,
color = ground_truth_label)) +
geom_density(alpha = 0.3, linewidth = 1.2) +
scale_fill_manual(values = c(
"Black"      = "#c23b23",
"White"      = "#2b7de9",
"Ambiguous"  = "gray40"
)) +
scale_color_manual(values = c(
"Black"      = "#c23b23",
"White"      = "#2b7de9",
"Ambiguous"  = "gray40"
)) +
scale_x_continuous(limits = c(0, 100), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "% Reported Black", y = "Density") +
theme_minimal(base_size = 14) +
theme(
panel.grid = element_blank(),
axis.line = element_line(color = "black")
)
df %>%
distinct(speaker, percent_reported_black) %>%
filter(!is.na(percent_reported_black)) %>%
mutate(category = substr(speaker, 1, 2)) %>%
ggplot(aes(x = percent_reported_black,
fill = category,
color = category)) +
geom_density(alpha = 0.3, linewidth = 1.2) +
scale_fill_manual(values = c(
"BF" = "#c23b23",
"BM" = "#6f42c1",
"WF" = "#2b7de9",
"WM" = "#28a745"
)) +
scale_color_manual(values = c(
"BF" = "#c23b23",
"BM" = "#6f42c1",
"WF" = "#2b7de9",
"WM" = "#28a745"
)) +
scale_x_continuous(limits = c(0, 100), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "% Reported Black", y = "Density") +
theme_minimal(base_size = 14) +
theme(
panel.grid = element_blank(),
axis.line = element_line(color = "black")
)
ggplot(df_density,
aes(x = percent_reported_black,
fill = ground_truth_label,
color = ground_truth_label)) +
geom_density(alpha = 0.3, linewidth = 1.2) +
scale_fill_manual(values = c(
"Black"      = "#c23b23",
"White"      = "#2b7de9",
"Ambiguous"  = "gray40"
)) +
scale_color_manual(values = c(
"Black"      = "#c23b23",
"White"      = "#2b7de9",
"Ambiguous"  = "gray40"
)) +
scale_x_continuous(limits = c(0, 100), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "% Reported Black", y = "Density") +
theme_minimal(base_size = 14) +
theme(
panel.grid = element_blank(),
axis.line = element_line(color = "black")
)
ggplot(df_plot,
aes(x = ground_truth_label,
y = percent_reported_black,
color = ground_truth_label)) +
geom_jitter(width = 0.15, size = 4, alpha = 0.9) +
scale_color_manual(values = c(
"Black"      = "#c23b23",
"White"      = "#2b7de9",
"Ambiguous"  = "gray40"
)) +
labs(
x = "Ground Truth Label",
y = "% Reported Black",
color = "Ground Truth Label"
) +
theme_minimal(base_size = 14) +
theme(
axis.line = element_line(color = "black"),
panel.grid = element_blank()
)
ggplot(speaker_clusters2,
aes(x = percent_reported_black,
y = fct_reorder(speaker, percent_reported_black),
color = cluster)) +
geom_point(size = 5, alpha = 0.9) +
scale_color_manual(values = c(
"1" = "#2b7de9",  # White cluster
"2" = "#c23b23",  # Black cluster
"3" = "gray40"    # Ambiguous cluster
)) +
facet_wrap(~ category, scales = "free_y") +
labs(
x = "% Reported Black",
y = "Speaker",
color = "Cluster",
title = "Cluster Assignments by Speaker Category"
) +
theme_minimal(base_size = 14) +
theme(
panel.grid = element_blank(),
axis.line = element_line(color = "black"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(color = "black"),
strip.text = element_text(face = "bold", size = 14)
)
ggplot(speaker_clusters2,
aes(x = percent_reported_black,
y = fct_reorder(speaker, percent_reported_black),
color = cluster)) +
geom_point(size = 5, alpha = 0.9) +
scale_color_manual(values = c(
"1" = "#2b7de9",  # White cluster
"2" = "#c23b23",  # Black cluster
"3" = "gray40"    # Ambiguous cluster
)) +
facet_wrap(~ category, scales = "free_y") +
labs(
x = "% Reported Black",
y = "Speaker",
color = "Cluster",
#title = "Cluster Assignments by Speaker Category"
) +
theme_minimal(base_size = 14) +
theme(
panel.grid = element_blank(),
axis.line = element_line(color = "black"),
axis.text.y = element_text(color = "black"),
axis.text.x = element_text(color = "black"),
strip.text = element_text(face = "bold", size = 14)
)
ggplot(df_plot,
aes(x = ground_truth_label,
y = percent_reported_black,
color = ground_truth_label)) +
geom_jitter(width = 0.15, size = 4, alpha = 0.9) +
scale_color_manual(values = c(
"Black"      = "#c23b23",
"White"      = "#2b7de9",
"Ambiguous"  = "gray40"
)) +
labs(
x = "Ground Truth Label",
y = "% Reported Black",
color = "Ground Truth Label"
) +
theme_minimal(base_size = 14) +
theme(
axis.line = element_line(color = "black"),
panel.grid = element_blank()
)
ggplot(df_density,
aes(x = percent_reported_black,
fill = ground_truth_label,
color = ground_truth_label)) +
geom_density(alpha = 0.3, linewidth = 1.2) +
scale_fill_manual(values = c(
"Black"      = "#c23b23",
"White"      = "#2b7de9",
"Ambiguous"  = "gray40"
)) +
scale_color_manual(values = c(
"Black"      = "#c23b23",
"White"      = "#2b7de9",
"Ambiguous"  = "gray40"
)) +
scale_x_continuous(limits = c(0, 100), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "% Reported Black", y = "Density") +
theme_minimal(base_size = 14) +
theme(
panel.grid = element_blank(),
axis.line = element_line(color = "black")
)
plot_personality(df_filtered, friendly)
plot_personality(df_filtered, trustworthy)
# plotting function
plot_personality <- function(data, trait_col) {
trait_col <- rlang::ensym(trait_col)
ggplot(data,
aes(x = ground_truth_label,
y = !!trait_col,
fill = ground_truth_label,
color = ground_truth_label)) +
geom_violin(alpha = 0.5, trim = FALSE) +
geom_jitter(width = 0.15, size = 1.7, alpha = 0.7) +
scale_fill_manual(values = c(
"Black"      = "#c23b23",
"White"      = "#2b7de9",
"Ambiguous"  = "gray40"
)) +
scale_color_manual(values = c(
"Black"      = "#c23b23",
"White"      = "#2b7de9",
"Ambiguous"  = "gray40"
)) +
labs(
x = "Ground Truth Label",
y = trait_col,
fill = "Ground Truth Label",
color = "Ground Truth Label"
) +
theme_minimal(base_size = 14) +
theme(
panel.grid = element_blank(),
axis.line = element_line(color = "black"),
axis.text.x = element_text(color = "black"),
axis.title = element_text(color = "black")
)
}
plot_personality(df_filtered, friendly)
plot_personality(df_filtered, trustworthy)
df_filtered
# run models
result_competent     <- fit_personality_model_clean("competent")
result_competent
plot_human_likeness(speaker_personality, competent)
plot_personality(speaker_personality, friendly)
library(tidyverse)
library(factoextra)
library(ggridges)
library(patchwork)
library(FactoMineR)
library(factoextra)
library(caret)
library(CAvariants)
library(lme4)
library(broom.mixed)
library(lmerTest)
library(cluster)
library(forcats)
# Load data
df <- read_csv("/Users/noahkhaloo/Desktop/TTS_perception/data/survey_results/survey_results.csv")
# Standard error function
se <- function(x) sd(x, na.rm = TRUE) / sqrt(sum(!is.na(x)))
# -------------------------------
# RACE AGREEMENT
# -------------------------------
agreement_by_category_and_speaker <- df %>%
filter(!is.na(speaker), block == "Race") %>%
mutate(
speaker_category = str_sub(speaker, 1, 2),
true_race = case_when(
str_starts(speaker, "B") ~ "Black",
str_starts(speaker, "W") ~ "White"
),
agreement = perceived_race == true_race
) %>%
group_by(speaker_category, speaker) %>%
summarise(
percent_agreement = mean(agreement, na.rm = TRUE) * 100,
se = se(agreement) * 100,
.groups = "drop"
)
agreement_by_category <- agreement_by_category_and_speaker %>%
group_by(speaker_category) %>%
summarise(
category_percent_agreement = mean(percent_agreement),
se = se(percent_agreement),
.groups = "drop"
)
# Plot 1
ggplot(agreement_by_category,
aes(x = speaker_category,
y = category_percent_agreement,
fill = speaker_category)) +
geom_col(width = 0.6, color = "black") +
geom_errorbar(aes(ymin = category_percent_agreement - se,
ymax = category_percent_agreement + se),
width = 0.15, linewidth = 0.8) +
geom_text(aes(label = sprintf("%.1f%%", category_percent_agreement),
y = category_percent_agreement + se + 3),
vjust = 0, size = 4.5) +
scale_fill_manual(values = c("BF" = "#c23b23",
"BM" = "#6f42c1",
"WF" = "#2b7de9",
"WM" = "#28a745")) +
labs(x = "Speaker Category", y = "Agreement with label") +
scale_y_continuous(expand = expansion(mult = c(0, 0))) +
coord_cartesian(ylim = c(0, 100)) +
theme_minimal(base_size = 14) +
theme(
legend.position = "none",
axis.line = element_line(color = "black"),
panel.grid = element_blank(),
axis.text = element_text(color = "black"),
axis.title = element_text(color = "black")
)
# -------------------------------
# GENDER AGREEMENT
# -------------------------------
gender_agreement_race_gender <- df %>%
filter(!is.na(gender_scale), !is.na(speaker)) %>%
mutate(
true_gender = if_else(str_sub(speaker, 2, 2) == "F", "Female", "Male"),
true_race = if_else(str_sub(speaker, 1, 1) == "B", "Black", "White"),
perceived_gender = if_else(gender_scale >= 4, "Male", "Female"),
agree = perceived_gender == true_gender
) %>%
group_by(true_race, true_gender) %>%
summarise(
percent_agreement = mean(agree) * 100,
sd_agreement = sd(as.numeric(agree)) * 100,
n = n(),
.groups = "drop"
)
# -------------------------------
# Add %Reported Black
# -------------------------------
df <- df %>%
group_by(speaker) %>%
mutate(percent_reported_black =
mean(perceived_race == "Black", na.rm = TRUE) * 100) %>%
ungroup()
# -------------------------------
# Density plot of %Reported Black
# -------------------------------
df %>%
distinct(speaker, percent_reported_black) %>%
filter(!is.na(percent_reported_black)) %>%
mutate(category = substr(speaker, 1, 2)) %>%
ggplot(aes(x = percent_reported_black,
fill = category,
color = category)) +
geom_density(alpha = 0.3, linewidth = 1.2) +
scale_fill_manual(values = c(
"BF" = "#c23b23",
"BM" = "#6f42c1",
"WF" = "#2b7de9",
"WM" = "#28a745"
)) +
scale_color_manual(values = c(
"BF" = "#c23b23",
"BM" = "#6f42c1",
"WF" = "#2b7de9",
"WM" = "#28a745"
)) +
scale_x_continuous(limits = c(0, 100), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "% Reported Black", y = "Density") +
theme_minimal(base_size = 14) +
theme(
panel.grid = element_blank(),
axis.line = element_line(color = "black")
)
# -------------------------------
# K-MEANS CLUSTERING
# -------------------------------
speaker_features <- df %>%
group_by(speaker) %>%
summarise(
percent_reported_black = mean(perceived_race == "Black", na.rm = TRUE) * 100,
mean_gender_scale = mean(gender_scale, na.rm = TRUE)
) %>%
drop_na()
scaled_features <- speaker_features %>%
select(percent_reported_black) %>%
scale()
set.seed(123)
wss <- sapply(1:10, function(k) {
kmeans(scaled_features, centers = k, nstart = 50)$tot.withinss
})
plot(1:10, wss, type = "b",
pch = 19, frame = FALSE,
xlab = "Number of clusters K",
ylab = "Total within-cluster sum of squares")
library(tidyverse)
library(factoextra)
library(ggridges)
library(patchwork)
library(FactoMineR)
library(factoextra)
library(caret)
library(CAvariants)
library(lme4)
library(broom.mixed)
library(lmerTest)
library(cluster)
library(forcats)
# Load data
df <- read_csv("/Users/noahkhaloo/Desktop/TTS_perception/data/survey_results/survey_results.csv")
# Standard error function
se <- function(x) sd(x, na.rm = TRUE) / sqrt(sum(!is.na(x)))
# -------------------------------
# RACE AGREEMENT
# -------------------------------
agreement_by_category_and_speaker <- df %>%
filter(!is.na(speaker), block == "Race") %>%
mutate(
speaker_category = str_sub(speaker, 1, 2),
true_race = case_when(
str_starts(speaker, "B") ~ "Black",
str_starts(speaker, "W") ~ "White"
),
agreement = perceived_race == true_race
) %>%
group_by(speaker_category, speaker) %>%
summarise(
percent_agreement = mean(agreement, na.rm = TRUE) * 100,
se = se(agreement) * 100,
.groups = "drop"
)
agreement_by_category <- agreement_by_category_and_speaker %>%
group_by(speaker_category) %>%
summarise(
category_percent_agreement = mean(percent_agreement),
se = se(percent_agreement),
.groups = "drop"
)
# Plot 1
ggplot(agreement_by_category,
aes(x = speaker_category,
y = category_percent_agreement,
fill = speaker_category)) +
geom_col(width = 0.6, color = "black") +
geom_errorbar(aes(ymin = category_percent_agreement - se,
ymax = category_percent_agreement + se),
width = 0.15, linewidth = 0.8) +
geom_text(aes(label = sprintf("%.1f%%", category_percent_agreement),
y = category_percent_agreement + se + 3),
vjust = 0, size = 4.5) +
scale_fill_manual(values = c("BF" = "#c23b23",
"BM" = "#6f42c1",
"WF" = "#2b7de9",
"WM" = "#28a745")) +
labs(x = "Speaker Category", y = "Agreement with label") +
scale_y_continuous(expand = expansion(mult = c(0, 0))) +
coord_cartesian(ylim = c(0, 100)) +
theme_minimal(base_size = 14) +
theme(
legend.position = "none",
axis.line = element_line(color = "black"),
panel.grid = element_blank(),
axis.text = element_text(color = "black"),
axis.title = element_text(color = "black")
)
